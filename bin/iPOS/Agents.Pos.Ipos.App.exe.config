<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
  </configSections>
  <system.serviceModel>
    <diagnostics performanceCounters="All" />
    <extensions>
      <behaviorExtensions>
        <add name="internationalization" type="Pos.Agent.ApiV1.DataContracts.Internationalization.InternationalizationElement, Agents.Pos.ApiV1.Contracts" />
        <add name="restErrorHandling" type="Pos.Agent.ApiV1.DataContracts.ErrorHandling.RestErrorHandlingElement, Agents.Pos.ApiV1.Contracts" />
        <add name="invokesLogging" type="Pos.Agent.ApiV1.DataContracts.Logging.InvokeLoggingBehaviorExtensionElement, Agents.Pos.ApiV1.Contracts" />
      </behaviorExtensions>
      <bindingElementExtensions>
        <add name="gzipMessageEncoding" type="Pos.Agent.ApiV1.DataContracts.Compression.GZipMessageEncodingElement, Agents.Pos.ApiV1.Contracts" />
      </bindingElementExtensions>
    </extensions>
    <behaviors>
      <serviceBehaviors>
        <behavior name="DefaultTcpServiceBehavior">
          <internationalization />
          <!--Раскомментировать строку ниже при необходимости отладки всех входящих вызовов к службам (ответы служб также логируются)-->
          <!--<invokesLogging writeToDebugOutput="true" logRequestResponseMessages="true" excludeMethods="ping, GetFrontSettings, GetDeliverySettings" />-->
          <serviceThrottling maxConcurrentCalls="50000" maxConcurrentSessions="5000" maxConcurrentInstances="5000" />
          <serviceDebug includeExceptionDetailInFaults="true" />
          <serviceTimeouts transactionTimeout="00:00:30" />
        </behavior>
      </serviceBehaviors>
      <endpointBehaviors>
        <behavior name="V1Behavior">
          <dataContractSerializer maxItemsInObjectGraph="2147483647" />
          <clientCredentials>
            <serviceCertificate>
              <authentication certificateValidationMode="None" />
            </serviceCertificate>
          </clientCredentials>
        </behavior>
        <behavior name="DefaultTcpServiceBehavior">
          <dataContractSerializer maxItemsInObjectGraph="2147483647" />
        </behavior>
      </endpointBehaviors>
    </behaviors>
    <bindings>
      <customBinding>
        <binding name="PosApiV1SoapBinding" closeTimeout="00:00:10" openTimeout="00:00:30" sendTimeout="00:10:00" receiveTimeout="00:10:00">
          <transactionFlow />
          <security authenticationMode="SecureConversation" messageSecurityVersion="WSSecurity11WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10">
            <localClientSettings detectReplays="false" maxClockSkew="20:00:00" />
            <localServiceSettings detectReplays="false" maxClockSkew="20:00:00" inactivityTimeout="00:00:30" maxPendingSessions="10000" />
            <secureConversationBootstrap authenticationMode="UserNameForSslNegotiated" messageSecurityVersion="WSSecurity11WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10">
              <localClientSettings detectReplays="false" maxClockSkew="20:00:00" />
              <localServiceSettings detectReplays="false" maxClockSkew="20:00:00" inactivityTimeout="00:00:30" maxPendingSessions="10000" />
            </secureConversationBootstrap>
          </security>
          <textMessageEncoding>
            <readerQuotas maxDepth="32" maxStringContentLength="5242880" maxArrayLength="2147483646" maxBytesPerRead="4096" maxNameTableCharCount="5242880" />
          </textMessageEncoding>
          <httpTransport maxBufferPoolSize="2147483647" maxBufferSize="2147483647" maxReceivedMessageSize="2147483647" />
        </binding>
        <binding name="PosApiV11SoapBinding" closeTimeout="00:00:10" openTimeout="00:00:30" sendTimeout="00:10:00" receiveTimeout="00:10:00">
          <security authenticationMode="UserNameOverTransport" includeTimestamp="false">
            <localClientSettings detectReplays="false" />
          </security>
          <textMessageEncoding messageVersion="Soap12">
            <readerQuotas maxDepth="32" maxStringContentLength="5242880" maxArrayLength="2147483646" maxBytesPerRead="4096" maxNameTableCharCount="5242880" />
          </textMessageEncoding>
          <httpsTransport authenticationScheme="Basic" maxBufferPoolSize="2147483647" maxBufferSize="2147483647" maxReceivedMessageSize="2147483647" />
        </binding>
        <binding name="DefaultTcpBinding" sendTimeout="02:00:00" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:01:00">
          <binaryMessageEncoding maxReadPoolSize="2048" maxWritePoolSize="2048" maxSessionSize="1050578">
            <readerQuotas maxDepth="32" maxStringContentLength="5242880" maxArrayLength="2147483646" maxBytesPerRead="16384" maxNameTableCharCount="5242880" />
          </binaryMessageEncoding>
          <tcpTransport manualAddressing="false" maxBufferPoolSize="5242880" maxReceivedMessageSize="2147483647" connectionBufferSize="51200" hostNameComparisonMode="StrongWildcard" channelInitializationTimeout="00:00:10" maxBufferSize="2147483647" maxPendingConnections="1000" maxOutputDelay="00:00:00.2000000" maxPendingAccepts="5000" transferMode="Buffered" listenBacklog="20000" portSharingEnabled="false" teredoEnabled="false">
            <connectionPoolSettings groupName="default" leaseTimeout="00:05:00" idleTimeout="00:02:00" maxOutboundConnectionsPerEndpoint="20000" />
          </tcpTransport>
        </binding>
        <!-- Выделен отдельно, т.к. "нежелательные" особенности (Streamed, Transaction Flow) присутствуют в настройках iikoFront -->
        <binding name="PosServicesBinding" sendTimeout="02:00:00" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:01:00">
          <binaryMessageEncoding maxReadPoolSize="2048" maxWritePoolSize="2048" maxSessionSize="1050578">
            <readerQuotas maxDepth="32" maxStringContentLength="5242880" maxArrayLength="2147483646" maxBytesPerRead="16384" maxNameTableCharCount="5242880" />
          </binaryMessageEncoding>
          <tcpTransport manualAddressing="false" maxBufferPoolSize="5242880" maxReceivedMessageSize="2147483647" connectionBufferSize="51200" hostNameComparisonMode="StrongWildcard" channelInitializationTimeout="00:00:10" maxBufferSize="2147483647" maxPendingConnections="1000" maxOutputDelay="00:00:00.2000000" maxPendingAccepts="5000" transferMode="Streamed" listenBacklog="20000" portSharingEnabled="false" teredoEnabled="false">
            <connectionPoolSettings groupName="default" leaseTimeout="00:05:00" idleTimeout="00:02:00" maxOutboundConnectionsPerEndpoint="20000" />
          </tcpTransport>
        </binding>
      </customBinding>
      <netTcpBinding>
        <binding name="PingBinding" closeTimeout="00:00:10" openTimeout="00:00:10" sendTimeout="00:00:10" receiveTimeout="00:00:10" maxBufferPoolSize="10240" maxBufferSize="10240" maxReceivedMessageSize="10240" maxConnections="1000" listenBacklog="10000" transactionFlow="false" transferMode="Streamed">
          <security mode="None" />
        </binding>
      </netTcpBinding>
    </bindings>
    <services>
      <service name="Agents.Pos.Ipos.Bll.Controllers.PosIikoNetController" behaviorConfiguration="DefaultTcpServiceBehavior">
        <endpoint address="net.tcp://0.0.0.0:9100/IikoNetPos" binding="customBinding" bindingConfiguration="PosServicesBinding" contract="Pos.Agent.ApiV1.DataContracts.WcfContracts.IIikoNetService" />
      </service>
      <service name="Agents.Pos.Ipos.Bll.Controllers.IikoNetPosConfigurationController" behaviorConfiguration="DefaultTcpServiceBehavior">
        <endpoint address="net.tcp://0.0.0.0:9100/IikoNetPosConfiguration" binding="customBinding" bindingConfiguration="PosServicesBinding" contract="Pos.Agent.ApiV1.DataContracts.WcfContracts.IIikoNetPosConfigurationService" />
      </service>
    </services>
    <client>
      <!--endpoint address="http://localhost:9000/" binding="customBinding" bindingConfiguration="PosApiV1SoapBinding" contract="Pos.Agent.ApiV1.DataContracts.WcfContracts.IIikoNetService" name="IIikoNetService" behaviorConfiguration="V1Behavior">
        <identity>
          <certificate encodedValue="AwAAAAEAAAAUAAAA8U5jpRDh+N949ufXtg2lig5ZDNkgAAAAAQAAAB8CAAAwggIbMIIBhKADAgECAhABRTv6XxkHj02V6KZmWMFqMA0GCSqGSIb3DQEBBAUAMBMxETAPBgNVBAMTCGlpa28ubmV0MB4XDTEwMTIwMzE1MDAyN1oXDTM5MTIzMTIzNTk1OVowEzERMA8GA1UEAxMIaWlrby5uZXQwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBALUtbuxd+zC4Qywq1hXmHfYpVdr7Q1zlieDHqgaI+BClTazYmNcCEvYNNFAV6n9qEDsMZnSxuir8OA9LyIlol9wGxXcI5ZJGMynvAdW1eiyeN9WIkDMyCkP93qgxSNoWC7X3CuwIbrnXjdRPvsFTgFDjb/rTYCV/k0WtTniSQhHBAgMBAAGjcDBuMCYGCisGAQQBgjcCAQoEGDAWoBSAEmh0dHA6Ly93d3cuaWlrby5ydTBEBgNVHQEEPTA7gBCOG3rvLMHzEalZlK6jSmtNoRUwEzERMA8GA1UEAxMIaWlrby5uZXSCEAFFO/pfGQePTZXopmZYwWowDQYJKoZIhvcNAQEEBQADgYEAkmHTsCcLRvRTjBtVv+x9KfE4H6rVRcP6mvYyc1IUFvyrhueqkoKpxyGPy5BPFrfTPiTQ8PMohZcXqBv5wcI70oLjlruG9euYrrGQnay8WpdX/ZLIYid14/hhubBuWBRZI8QOrduPIIMdu5thw7GaMCh8R7jFzYzLBL1WT3sXxr8=" />
        </identity>
      </endpoint-->
      <endpoint address="https://plazius.ru:9004/" binding="customBinding" bindingConfiguration="PosApiV11SoapBinding" contract="Pos.Agent.ApiV1.DataContracts.WcfContracts.IIikoNetService" name="IIikoNetService" behaviorConfiguration="V1Behavior">
      </endpoint>
      <endpoint address="net.tcp://plazius.ru:9005/iikoNetReplication" binding="customBinding" bindingConfiguration="DefaultTcpBinding" contract="iikoNet.Service.Contracts.Replication.IIikoNetReplicationService" name="IIikoNetReplicationService" behaviorConfiguration="DefaultTcpServiceBehavior" />
      <endpoint address="net.tcp://plazius.ru:9001/Ping" binding="netTcpBinding" bindingConfiguration="PingBinding" contract="iikoNet.Service.Contracts.Front.IPingService" name="IPingService"></endpoint>
    </client>
  </system.serviceModel>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7.1" />
  </startup>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-12.0.0.0" newVersion="12.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.ComponentModel.Annotations" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.2.1.0" newVersion="4.2.1.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.Data.Sqlite" publicKeyToken="adb9793829ddae60" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-2.2.2.0" newVersion="2.2.2.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="SQLitePCLRaw.core" publicKeyToken="1488e028ca7ab535" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-1.1.12.351" newVersion="1.1.12.351" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.EntityFrameworkCore" publicKeyToken="adb9793829ddae60" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-2.2.2.0" newVersion="2.2.2.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.EntityFrameworkCore.Relational" publicKeyToken="adb9793829ddae60" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-2.2.2.0" newVersion="2.2.2.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.EntityFrameworkCore.Abstractions" publicKeyToken="adb9793829ddae60" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-2.2.2.0" newVersion="2.2.2.0" />
      </dependentAssembly>
    </assemblyBinding>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Data.Common" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.2.0.0" newVersion="4.2.0.0" />
      </dependentAssembly>
    </assemblyBinding>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Diagnostics.StackTrace" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.1.0.0" newVersion="4.1.0.0" />
      </dependentAssembly>
    </assemblyBinding>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Diagnostics.Tracing" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.2.0.0" newVersion="4.2.0.0" />
      </dependentAssembly>
    </assemblyBinding>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Globalization.Extensions" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.1.0.0" newVersion="4.1.0.0" />
      </dependentAssembly>
    </assemblyBinding>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.IO.Compression" publicKeyToken="b77a5c561934e089" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.2.0.0" newVersion="4.2.0.0" />
      </dependentAssembly>
    </assemblyBinding>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Net.Http" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.2.0.0" newVersion="4.2.0.0" />
      </dependentAssembly>
    </assemblyBinding>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Net.Sockets" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.2.0.0" newVersion="4.2.0.0" />
      </dependentAssembly>
    </assemblyBinding>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Runtime.Serialization.Primitives" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.2.0.0" newVersion="4.2.0.0" />
      </dependentAssembly>
    </assemblyBinding>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Security.Cryptography.Algorithms" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.3.0.0" newVersion="4.3.0.0" />
      </dependentAssembly>
    </assemblyBinding>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Security.SecureString" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.1.0.0" newVersion="4.1.0.0" />
      </dependentAssembly>
    </assemblyBinding>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Threading.Overlapped" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.1.0.0" newVersion="4.1.0.0" />
      </dependentAssembly>
    </assemblyBinding>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Xml.XPath.XDocument" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.1.0.0" newVersion="4.1.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="mssqllocaldb" />
      </parameters>
    </defaultConnectionFactory>
    <providers>
      <provider invariantName="System.Data.SqlClient" type="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer" />
      <provider invariantName="System.Data.SQLite.EF6" type="System.Data.SQLite.EF6.SQLiteProviderServices, System.Data.SQLite.EF6" />
    </providers>
  </entityFramework>
</configuration>